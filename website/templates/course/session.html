{% extends "auth/base.html" %}
{% load static %}
{% block content %}

<!-- Include the external JavaScript file -->
<script src="{% static 'js/newSession.js' %}"></script>

<div class="p-4 font-semibold text-gray-700 mb-4">
  <h3>Course</h3>
</div>

<div class="p-4 bg-white rounded-lg shadow-xs">
    {% if asana %}
    <div>
        <h2 class="text-2xl font-semibold text-gray-800">
            {{ asana.1 }}</h2>
        {% if asana.2 %}
            <ol class="flex flex-col list-decimal ml-8">
                {% for technique, images in asana.2.items %}
                    <li class="step-container fade-in-out mt-4">
                        <p class="step-text">
                            {{ technique }}</p>
                        {% if images %}
                            <div class="images-container">
                                <ul>
                                    {% for image_path in images %}
                                        {% if image_path %}
                                            <li class="flex items-center justify-center">
                                                <img src="{% static 'public/assets/images/' %}{{ image_path }}" alt="Step image" class="step-image rounded-lg w-[25%] h-[25%]">
                                            </li>
                                        {% else %}
                                            <!-- If there is no image, do not display an image tag at all -->
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endif %}
                    </li>
                {% endfor %}
            </ol>
        {% else %}
            <p>No steps for this asana.</p>
        {% endif %}
    </div>

    <div class="flex justify-between mt-4">
        <a href="?action=previous" class="flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded hover:bg-green-500"
        >Previous</a>
        <a href="?action=next" class="flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded hover:bg-green-500"
        >Next</a>
    </div>
    {% else %}
        <p>No asanas available.</p>
    {% endif %}

    {% if is_last_step %}
    <div class="p-4 mt-4 bg-green-100 text-green-800 rounded-lg">
        <p>Congratulations! You have completed all the yoga asanas in the course.</p>
    </div>
    {% endif %}

</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var steps = document.querySelectorAll('.step-container');
        steps.forEach(function(step, index) {
            setTimeout(function() {
                step.style.animationDelay = index * 5 + "s";
                step.classList.add('fade-in-out');
                step.addEventListener('animationend', function() {
                    step.style.display = 'none'; // Hide the step after the animation ends
                });
            }, index * 5000); // Delay next step by the duration of the fade-out (5000ms)
        });
    });
</script>

{% endblock content %}
</body>
</html>
